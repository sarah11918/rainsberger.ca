---
    import XElement from 'astro-xelement';

    const {button:Button,div:Display} = XElement
---
    
    <Display @do={(element,store)=>{
        store.typicode = {id:1}

        const fetchData = async (fn) =>{
          await fetch(`https://jsonplaceholder.typicode.com/posts/${store.typicode.id}`)
          .then(response => response.json()).then(json=>fn(json))}

        store.printTypicode=async()=>{
          try{
            fetchDisplay.textContent="Loading..."
            await fetchData((data)=>{
              fetchDisplay.textContent = `Post Id:${data.id}\nTitle: ${data.title}\nBody:\n${data.body}`
            })
          }catch(err){
            fetchData.textContent = "Error Fetching Data"
          }
        }
    }}>
      <p id='fetchDisplay' style="white-space: pre"></p>
       <Button @click={(event,store)=>{
          store.printTypicode()
          store.typicode.id++
         this.textContent="Click for more data"
       }}>Click for Data</Button>
    </Display>